---
title: AWS Integration
sidebar_label: AWS
---

# AWS Integration

The AWS Integration automatically imports a hierarchy that mirrors your AWS Organization’s structure, creating a folder for each AWS Organizational Unit (OU) and a [connection](/pipes/docs/workspaces/connections) for each account in your AWS Organization.

This integration continuously updates the configuration as your organization evolves, automatically adding, removing, and modifying connections and folders when accounts or OUs are created, deleted, or changed.


## Creating the AWS Integration

You can create an integration for a [tenant](/pipes/docs/accounts/tenant/) or an [organization](/pipes/docs/accounts/org). The scope of the resources it creates depends on where the integration is set up. The resulting connections and folders can only be shared within the entity where it was created.

| Level                        | Plan                       | Description
|------------------------------|----------------------------|----------------
| [Tenant](/pipes/docs/accounts/tenant) | [Enterprise](/pipes/docs/accounts/tenant#enterprise-plan) | Selectively share AWS connections and folders with any (or all) organization or workspace in the tenant.
| [Org](/pipes/docs/accounts/org) | [Team](/pipes/docs/accounts/org#team-plan) or [Enterprise](/pipes/docs/accounts/tenant#enterprise-plan)  | Selectively share AWS connections and folders with any (or all) workspace in the organization.


First, navigate to the **Integrations** page for the appropriate resource:
- To configure an AWS integration for your **Tenant**, click the double arrow button from the tenant switcher at the top of the Pipes console, select your tenant, and then select **Tenant Settings**. This option will only be visible in a custom tenant for which you are a [tenant owner](/pipes/docs/accounts/tenant/people#tenant-roles).  Once you've selected your tenant, go to the **Integrations** tab to manage the integrations for the tenant.
- To configure an AWS integration for your **Organization**, click the double arrow button from the organization switcher at the top of the page and select the organization from the dropdown.  Once you've selected your organization, go to the **Integrations** tab to manage the integrations for the organization.



![](/images/docs/pipes/org-integrations-tab.png)

Next, click the **New Integration** button. You will be asked to select the type of integration to be created.

![](/images/docs/pipes/org-integrations-new-aws.png)

Select **AWS** and click on **Next**.

Provide a **Handle** for the integration.  

![](/images/docs/pipes/org-integrations-aws-handle.png)

The handle should be meaningful and adhere to the following rules:
- For an **organization in the Pipes tenant**, the handle must be unique inside the organization.
- For an **organization in a custom tenant**, the handle must be unique across both the organization and the tenant’s other integrations.
- For a **custom tenant**, the handle must be unique across the tenant and all integrations associated with its organizations.

Once you have selected an appropriate handle, click **Next**.


Configure the **Discovery Settings**, including the credentials that Pipes should use *to discover the organization's resources*.  

![](/images/docs/pipes/org-integrations-aws-discovery.png)


These credentials need permission to read the organization data in the AWS Organizations master / management account.  You may either authenticate using a cross-account role (recommended) or an access key pair.

- To use a **cross-account role**, select **Cross-Account Role** from the **Access Mode** dropdown. You must create a role in the target account with the appropriate trust policy and permissions. This can be done manually, or you can download a Terraform or CloudFormation template generated by Pipes to automate the process. Follow the **Automatic Setup** or **Manual Setup** instructions, then enter the **Role ARN** and **External ID**.

- To use a key pair, select Access Key from the Access Mode dropdown, then enter the Access Key and Secret Key.

Click **Test Discovery** to verify the credentials. Once satisfied, click **Next**.

Configure the **Connection settings**.

![](/images/docs/pipes/org-integrations-aws-setup.png)


Optionally, provide a **Handle Prefix** to be pre-pended to the names of connections created from this integration. This is optional but may be useful for organizational purposes or to ensure the uniqueness of the generated connection handles.

Next, set up the trust relationship for the discovered accounts. To allow Pipes to access these accounts, you need to create a cross-account role in each discovered account. You can either:
- Manually create the roles, or
- Use a CloudFormation StackSet generated by Pipes to automate the setup process.

Choose your preferred approach — **Automatic Setup** or **Manual Setup** and enter the **Role Name** and **External ID**. Pipes will dynamically generate the Role ARN for each discovered account using its AWS Account ID and the specified Role Name. Finally, select the **Regions** where you want to configure child connections.

Important Notes for Cross-Account Role Setup:
- Pipes recommends using the same Role Name across all accounts to simplify configuration.
- Running the CloudFormation StackSet from the management account will create the required roles in all accounts within the AWS Organization, except for the management account itself.
- If the Role Name specified in Discovery settings differs from the one used in Connection settings, you must deploy a separate CloudFormation Stack in the management account. Use the Download Management Role CloudFormation Stack button to obtain the template for this role.

If desired, you can set advanced options for the child connections.  

![](/images/docs/pipes/org-integrations-aws-setup-advanced.png)

These options will be inherited by all connections imported by the integration.  You can also set or change these options on a per-connection basis after the connections have been imported.


Click the **Test Connection** button to verify that the credentials are configured correctly, then click **Next**.


Finally, select the [Permissions](/pipes/docs/accounts/tenant/connections#permissions).  

![](/images/docs/pipes/org-integrations-perms.png)


The permissions on this screen apply to the top-level folders and, therefore, to *all connections and folders* discovered by this integration.  If you want to assign permissions more granularly, on a per-subfolder or per-connection basis, select **No Permissions** at this time, and then manage the permissions on the connections and folders once they have been discovered.

Note also that **All Workspaces** will not only add permissions for the existing organization workspaces but will also allow access for any new workspaces that are created.

After you have made your selections, click **Create Integration**.  Pipes will begin discovering your organization structure and creating folders and connections.


## Modifying the AWS Integration

After you have created an integration, you can change its **Handle**, **Handle Prefix**, or **Credentials**.  You can also change the **Permissions** and **Handle** individually for each child folder or connection.

*Modifying the integration after it has been created will potentially impact any workspaces that use its connections!*
- Changing the **Handle Prefix** will change the handles of all of its connections.
This means that the schema names will change in any workspace to which they are attached.  The schema names, in turn, impact the search path and aggregators that use wildcards.
- Discovery of accounts and OUs occurs using the supplied **Credentials**.  If changing the credentials affects access to these accounts and OUs, that will be reflected in the folders and connections. For example, if the new credentials do not have access to some OUs or accounts that were visible to the previous credentials, then the corresponding folders and connections will be deleted and removed from any workspaces where they are attached.

To modify the integration, navigate to the **Integrations** page for the appropriate resource:
- To configure an AWS integration for your **Tenant**, click the double arrow button from the tenant switcher at the top of the Pipes console, select your tenant, and then select **Tenant Settings**. This option will only be visible in a custom tenant for which you are a [tenant owner](/pipes/docs/accounts/tenant/people#tenant-roles).  Once you've selected your tenant, go to the **Integrations** tab to manage the integrations for the tenant.
- To configure an AWS integration for your **Organization**, click the double arrow button from the organization switcher at the top of the page and select the organization from the dropdown.  Once you've selected your organization, go to the **Integrations** tab to manage the integrations for the organization.


In the list of integrations, click the gear icon next to the integration that you want to modify.

You can change credentials used for discovery in the **Discovery Settings** section of the **Config** tab.
![](/images/docs/pipes/org-integrations-aws-settings-config-discovery.png)

You can also change the **Connection Settings** from the **Config** tab, including the **Handle Prefix**, **Regions**, the connection credentials, and the **Advanced Options**,

![](/images/docs/pipes/org-integrations-aws-settings-config-connection.png)

Make the desired changes and click **Save**.


You can modify the **Handle** from the **Advanced** tab.

![](/images/docs/pipes/org-integrations-aws-settings-advanced.png)

Enter the new handle and click **Save**.

You can view the connection tree from the **Connections** tab.  Click on a connection or folder to view or change its properties. You can change the **Permissions** and **Handle** from its **Settings** tab.


## Deleting the AWS Integration

You can delete an integration from its **Advanced** page.

*If you delete an integration, all of its associated folders and connections will be deleted and removed from all workspaces.  This action is not reversible!*

Navigate to the **Integrations** page for the appropriate resource:
- To delete an AWS integration for your **Tenant**, click the double arrow button from the tenant switcher at the top of the Pipes console, select your tenant, and then select **Tenant Settings**. This option will only be visible in a custom tenant for which you are a [tenant owner](/pipes/docs/accounts/tenant/people#tenant-roles).  Once you've selected your tenant, go to the **Integrations** tab to manage the integrations for the tenant.
- To delete an AWS integration for your **Organization**, click the double arrow button from the organization switcher at the top of the page and select the organization from the dropdown.  Once you've selected your organization, go to the **Integrations** tab to manage the integrations for the organization.


Go to the **Advanced** page and click the **Delete Integration** button. 

![](/images/docs/pipes/org-integrations-aws-settings-advanced.png)

You will be asked to enter the handle to confirm deletion. 

![](/images/docs/pipes/org-integrations-aws-delete-confirm.png)

If you wish to *permanently delete the integration and all of its resources*, click **Delete**.